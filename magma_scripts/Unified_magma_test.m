/////UNIFIED MIXED ADDITION*********************************************************************
muadd:=function(X1, Z1, Y1, T1, X2, Y2)

	AA:=X1*X2;
	BB:=Y1*Y2;
	CC:=Z1*X2;
	DD:=T1*Y2;
	EE:=Z1-AA;
	FF:=Z1+AA;
	GG:=T1-BB;
	HH:=T1+BB;
	II:=X1+CC;
	JJ:=Y1+DD;
	X3:=GG*II;
	Z3:=HH*EE;
	Y3:=EE*JJ;
	T3:=GG*FF;
	return X3, Z3, Y3, T3;

end function;

K:=GF(2^256-587);

//C Input of ec_fp_madd_256H_u function(Obtained by Input Check). Used as input of muadd function.
X1 :=K!(3710769202890782869*(2^64)^0+12347696226371115620*(2^64)^1+16936367721086633166*(2^64)^2+4593309769997399859*(2^64)^3);
Z1 :=K!(475209264418545795*(2^64)^0+11279372046875613362*(2^64)^1+17145784125869301033*(2^64)^2+16001218500068176100*(2^64)^3);
Y1 :=K!(14652974502996211413*(2^64)^0+15312885296273428470*(2^64)^1+2970330174285031926*(2^64)^2+13719378186150298330*(2^64)^3);
T1 :=K!(2057390970295926455*(2^64)^0+2903920953576462692*(2^64)^1+7308895733420627660*(2^64)^2+3549150854781649256*(2^64)^3);
X2 :=K!(17214099353896039569*(2^64)^0+10947516949600597084*(2^64)^1+6729508884973405419*(2^64)^2+12462404735029847577*(2^64)^3);
Y2 :=K!(17488009978481698240*(2^64)^0+7519255469449889322*(2^64)^1+298038634787313150*(2^64)^2+18098329763170800525*(2^64)^3);

//C Output of ec_fp_madd_256H_u function(Obtained by Output Check).
X3 := 8610264381046090274*(2^64)^0+1426782889492977163*(2^64)^1+12123156530569274129*(2^64)^2+4446863002432060368*(2^64)^3;
Z3 := 5840520351930116129*(2^64)^0+18064885864729158648*(2^64)^1+8942305314805047012*(2^64)^2+15948963266212480566*(2^64)^3;
Y3 := 2277438891660787766*(2^64)^0+17278676761317702835*(2^64)^1+9697784438911370319*(2^64)^2+6354388319368317195*(2^64)^3;
T3 := 693557601674030713*(2^64)^0+846409255441915678*(2^64)^1+7456349829611309766*(2^64)^2+11583704336892999059*(2^64)^3;

//The result of muadd function is stored in MX3, MZ3, MY3, MT3
MX3, MZ3, MY3, MT3 := muadd(X1, Z1, Y1, T1, X2, Y2);

//Check whether C and magma results are equal.
[MX3, MZ3, MY3, MT3] eq [X3, Z3, Y3, T3];


//********************************************************************************************

/////UNIFIED MIXED SUB************************************************************************
musub:=function(X1, Z1, Y1, T1, X2, Y2)

	AA:=X1*X2;
	BB:=Y1*Y2;
	CC:=Z1*X2;
	DD:=T1*Y2;
	EE:=Z1+AA;
	FF:=Z1-AA;
	GG:=T1+BB;
	HH:=T1-BB;
	II:=X1-CC;
	JJ:=Y1-DD;
	X3:=GG*II;
	Z3:=HH*EE;
	Y3:=EE*JJ;
	T3:=GG*FF;
	return X3, Z3, Y3, T3;

end function;

K:=GF(2^256-587);

//C Input of ec_fp_msub_256H_u function(Obtained by Input Check). Used as input of musub function.
X1 :=K!(10190992674836032275*(2^64)^0+4011953974070744810*(2^64)^1+16177596251111863786*(2^64)^2+3545938046246693260*(2^64)^3);
Z1 :=K!(5471184331219626958*(2^64)^0+3523626807831821390*(2^64)^1+12336366888152342674*(2^64)^2+8251595734831017327*(2^64)^3);
Y1 :=K!(12017661048275393259*(2^64)^0+8126170948546853219*(2^64)^1+16621975560700401955*(2^64)^2+12149921706748222682*(2^64)^3);
T1 :=K!(18178203893910918335*(2^64)^0+60332236221244712*(2^64)^1+10171978571717566543*(2^64)^2+15794593340468584162*(2^64)^3);
X2 :=K!(17214099353896039569*(2^64)^0+10947516949600597084*(2^64)^1+6729508884973405419*(2^64)^2+12462404735029847577*(2^64)^3);
Y2 :=K!(17488009978481698240*(2^64)^0+7519255469449889322*(2^64)^1+298038634787313150*(2^64)^2+18098329763170800525*(2^64)^3);

//C Output of ec_fp_msub_256H_u function(Obtained by Output Check).
X3 := 16516538196019002578*(2^64)^0+5510925066409444321*(2^64)^1+10499023921076055830*(2^64)^2+8064987866450549838*(2^64)^3;
Z3 := 4758078301142867345*(2^64)^0+1890391667594813078*(2^64)^1+9947983496020291265*(2^64)^2+17736207410064232270*(2^64)^3;
Y3 := 6871813788360550975*(2^64)^0+17543589613401231258*(2^64)^1+9802423841121462509*(2^64)^2+11836814595497490247*(2^64)^3;
T3 := 10150697129935973288*(2^64)^0+3475367563128515521*(2^64)^1+3637599612680538322*(2^64)^2+13735222552967008236*(2^64)^3;

//The result of musub function is stored in MX3, MZ3, MY3, MT3
MX3, MZ3, MY3, MT3 := musub(X1, Z1, Y1, T1, X2, Y2);

//Check whether C and magma results are equal.
[MX3, MZ3, MY3, MT3] eq [X3, Z3, Y3, T3];


//********************************************************************************************

/////UNIFIED ADD******************************************************************************
uadd:=function(X1, Z1, Y1, T1, X2, Z2, Y2, T2)
	UU:=X2+Z2;
	VV:=Y2+T2;
	AA:=X1*X2;
	BB:=Y1*Y2;
	CC:=Z1*Z2;
	DD:=T1*T2;
	EE:=X1+Z1;
	FF:=Y1+T1;
	GG:=AA+CC;
	HH:=BB+DD;
	II:=EE*UU;
	JJ:=FF*VV;
	KK:=BB;
	LL:=AA;
	MM:=DD-KK;
	NN:=DD+KK;
	PP:=CC-LL;
	QQ:=CC+LL;
	RR:=II-GG;
	SS:=JJ-HH;
	X3:=RR*MM;
	Z3:=PP*NN;
	Y3:=SS*PP;
	T3:=QQ*MM;
	return X3, Z3, Y3, T3;

end function;

K:=GF(2^256-587);

//C Input of ec_fp_add_256H_u function(Obtained by Input Check). Used as input of uadd function.
X1 :=K!(8610264381046090274*(2^64)^0+1426782889492977163*(2^64)^1+12123156530569274129*(2^64)^2+4446863002432060368*(2^64)^3);
Z1 :=K!(5840520351930116129*(2^64)^0+18064885864729158648*(2^64)^1+8942305314805047012*(2^64)^2+15948963266212480566*(2^64)^3);
Y1 :=K!(2277438891660787766*(2^64)^0+17278676761317702835*(2^64)^1+9697784438911370319*(2^64)^2+6354388319368317195*(2^64)^3);
T1 :=K!(693557601674030713*(2^64)^0+846409255441915678*(2^64)^1+7456349829611309766*(2^64)^2+11583704336892999059*(2^64)^3);
X2 :=K!(3710769202890782869*(2^64)^0+12347696226371115620*(2^64)^1+16936367721086633166*(2^64)^2+4593309769997399859*(2^64)^3);
Z2 :=K!(475209264418545795*(2^64)^0+11279372046875613362*(2^64)^1+17145784125869301033*(2^64)^2+16001218500068176100*(2^64)^3);
Y2 :=K!(14652974502996211413*(2^64)^0+15312885296273428470*(2^64)^1+2970330174285031926*(2^64)^2+13719378186150298330*(2^64)^3);
T2 :=K!(2057390970295926455*(2^64)^0+2903920953576462692*(2^64)^1+7308895733420627660*(2^64)^2+3549150854781649256*(2^64)^3);


//C Output of ec_fp_add_256H_u function(Obtained by Output Check).
X3 := 2677168834352646772*(2^64)^0+858908084207686913*(2^64)^1+11871756073938776425*(2^64)^2+6918397219574958116*(2^64)^3;
Z3 := 3840512545122887226*(2^64)^0+13187902669132895795*(2^64)^1+511874651513060151*(2^64)^2+13324391281596469053*(2^64)^3;
Y3 := 9488380821875637798*(2^64)^0+1311640226930715886*(2^64)^1+8072040486932281328*(2^64)^2+6220809245202450247*(2^64)^3;
T3 := 9175209688264288313*(2^64)^0+14121106911706464105*(2^64)^1+11790432463346266579*(2^64)^2+3165311590517825662*(2^64)^3;

//The result of uadd function is stored in MX3, MZ3, MY3, MT3
MX3, MZ3, MY3, MT3 := uadd(X1, Z1, Y1, T1, X2, Z2, Y2, T2);

//Check whether C and magma results are equal.
[MX3, MZ3, MY3, MT3] eq [X3, Z3, Y3, T3];

//********************************************************************************************




















/////MIXED DBL********************************************************************************
mdbl:=function(X1,Y1,xx)

	EE:= X1*Y1;
	X3:= X1+Y1;
	Y3:= X1-Y1;
	T3:= xx-EE;
	Z3:= EE+xx;

	AA:= X3*T3;
	BB:= Y3*Z3;
	CC:= T3*Z3;
	DD:= X3*Y3;

	X3:= AA+BB;
	Y3:= AA-BB;
	Z3:= CC-DD;
	T3:= CC+DD;

	return X3, Z3, Y3, T3;

end function;
K:=GF(2^256-587);
xx := K!1;

//C Input of ec_fp_mdbl_256H_u function(Obtained by Input Check). Used as input of mdbl function.
X1 :=K!(17214099353896039569*(2^64)^0+10947516949600597084*(2^64)^1+6729508884973405419*(2^64)^2+12462404735029847577*(2^64)^3);
Y1 :=K!(17488009978481698240*(2^64)^0+7519255469449889322*(2^64)^1+298038634787313150*(2^64)^2+18098329763170800525*(2^64)^3);


//C Output of ec_fp_mdbl_256H_u function(Obtained by Output Check).
X3 := 3710769202890782869*(2^64)^0+12347696226371115620*(2^64)^1+16936367721086633166*(2^64)^2+4593309769997399859*(2^64)^3;
Z3 := 475209264418545795*(2^64)^0+11279372046875613362*(2^64)^1+17145784125869301033*(2^64)^2+16001218500068176100*(2^64)^3;
Y3 := 14652974502996211413*(2^64)^0+15312885296273428470*(2^64)^1+2970330174285031926*(2^64)^2+13719378186150298330*(2^64)^3;
T3 := 2057390970295926455*(2^64)^0+2903920953576462692*(2^64)^1+7308895733420627660*(2^64)^2+3549150854781649256*(2^64)^3;


//The result of uadd function is stored in MX3, MZ3, MY3, MT3
MX3, MZ3, MY3, MT3 := mdbl(X1,Y1,xx);

//Check whether C and magma results are equal.
[MX3, MZ3, MY3, MT3] eq [X3, Z3, Y3, T3];


//********************************************************************************************

///// DBL*************************************************************************************
dbl:=function(X1,Y1,Z1,T1)

	AA:=X1*T1;
	BB:=Y1*Z1;
	CC:=T1*Z1;
	DD:=X1*Y1;
	X3:=AA+BB;
	Y3:=AA-BB;
	T3:=CC-DD;
	Z3:=CC+DD;
	AA:=X3*T3;
	BB:=Y3*Z3;
	CC:=T3*Z3;
	DD:=X3*Y3;
	X3:=AA+BB;
	Y3:=AA-BB;
	Z3:=CC-DD;
	T3:=CC+DD;
	return X3, Z3, Y3, T3;

end function;

K:=GF(2^256-587);

//C Input of ec_fp_madd_256H_u ec_fp_dbl_256H_u(Obtained by Input Check). Used as input of dbl function.
X1 :=K!(2677168834352646772*(2^64)^0+858908084207686913*(2^64)^1+11871756073938776425*(2^64)^2+6918397219574958116*(2^64)^3);
Z1 :=K!(3840512545122887226*(2^64)^0+13187902669132895795*(2^64)^1+511874651513060151*(2^64)^2+13324391281596469053*(2^64)^3);
Y1 :=K!(9488380821875637798*(2^64)^0+1311640226930715886*(2^64)^1+8072040486932281328*(2^64)^2+6220809245202450247*(2^64)^3);
T1 :=K!(9175209688264288313*(2^64)^0+14121106911706464105*(2^64)^1+11790432463346266579*(2^64)^2+3165311590517825662*(2^64)^3);


//C Output of ec_fp_dbl_256H_u function(Obtained by Output Check).
X3 := 12677561764898385588*(2^64)^0+1820587550206234737*(2^64)^1+4768176557504884165*(2^64)^2+13557507708740860784*(2^64)^3;
Z3 := 11403834493671296831*(2^64)^0+2775171861306101965*(2^64)^1+225858172514079988*(2^64)^2+12585225927516348918*(2^64)^3;
Y3 := 3525972509668794862*(2^64)^0+6133629536401764615*(2^64)^1+7822856687999266255*(2^64)^2+6496058260989319914*(2^64)^3;
T3 := 1874757214596786385*(2^64)^0+18046619394323222946*(2^64)^1+5400496199636821990*(2^64)^2+8788701404644568329*(2^64)^3;

//The result of dbl function is stored in MX3, MZ3, MY3, MT3
MX3, MZ3, MY3, MT3 := dbl(X1,Y1,Z1,T1);

//Check whether C and magma results are equal.
[MX3, MZ3, MY3, MT3] eq [X3, Z3, Y3, T3];
